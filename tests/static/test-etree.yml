- case: etree_from_string_returns_element
  main: |
    from lxml import etree
    document = etree.fromstring("<doc></doc>")
    reveal_type(document)  # NR: .+ "[\w\.]+\._Element"$

- case: etree_xmlparser_makeelement
  main: |
    from lxml import etree
    parser = etree.XMLParser()
    element = parser.makeelement("foobar")
    reveal_type(element)  # NR: .+ "[\w\.]+\._Element"$

- case: etree_htmlparser_makeelement
  main: |
    from lxml import etree
    parser = etree.HTMLParser()
    element = parser.makeelement("foobar")
    reveal_type(element)  # NR: .+ "[\w\.]+\._Element"$

- case: etree_tostring_encoding_default_or_type
  parametrized:
    - kwd: elem
      rt: builtins.bytes
    - kwd: "elem, encoding=str"
      rt: builtins.str
  main: |
    from lxml import etree
    elem: etree._Element
    string = etree.tostring({{ kwd }})
    reveal_type(string)  # N: Revealed type is "{{ rt }}"

- case: etree_tostring_encoding_specific
  parametrized:
    - val: ascii
      rt: builtins.bytes
    - val: utf8
      rt: builtins.bytes
    - val: unknown_encoding
      rt: builtins.bytes
    - val: unicode
      rt: builtins.str
  main: |
    from lxml import etree
    string = etree.tostring(etree.Element("foo"), encoding="{{ val }}")
    reveal_type(string)  # N: Revealed type is "{{ rt }}"

- case: etree_HTML_returns_element
  main: |
    from lxml import etree
    document = etree.HTML("<doc></doc>", parser=etree.HTMLParser(), base_url="http://example.com/")
    reveal_type(document)  # NR: .+ "[\w\.]+\._Element"$

- case: etree_XML_returns_element
  main: |
    from lxml import etree
    document = etree.XML("<doc></doc>", parser=etree.XMLParser(), base_url="http://example.com/")
    reveal_type(document)  # NR: .+ "[\w\.]+\._Element"$

- case: smartstring_properties_type
  parametrized:
    - prop: is_attribute
      rt: builtins.bool
    - prop: is_tail
      rt: builtins.bool
    - prop: is_text
      rt: builtins.bool
    - prop: attrname
      rt: "builtins.str | None"
  main: |
    from lxml.etree import _ElementUnicodeResult
    s: _ElementUnicodeResult
    reveal_type(s.{{ prop }})  # N: Revealed type is "{{ rt }}"

- case: smartstring_properties_ro
  parametrized:
    - prop: is_attribute
      val: True
    - prop: is_tail
      val: False
    - prop: is_text
      val: True
    - prop: attrname
      val: "'foo'"
  main: |
    from lxml.etree import _ElementUnicodeResult
    s: _ElementUnicodeResult
    s.{{ prop }} = {{ val }}  # E: Property "{{ prop }}" defined in "_ElementUnicodeResult" is read-only  [misc]

- case: smartstring_getparent
  main: |
    from lxml.etree import _ElementUnicodeResult, _Element
    s: _ElementUnicodeResult[_Element]
    p1 = s.getparent()
    reveal_type(p1)  # NR: .+ "[\w\.]+\._Element \| None"
